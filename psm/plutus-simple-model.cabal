cabal-version:      3.8
name:               plutus-simple-model
version:            0.6.0.0
synopsis:           Unit test library for plutus
description:        Unit test library for plutus with resource estimation
homepage:           https://github.com/mlabs-haskell/plutus-simple-model
bug-reports:        https://github.com/mlabs-haskell/plutus-simple-model
license:
license-file:
author:             Anton Kholomiov, Borja Bonet Segui, MLabs
maintainer:         <anton@mlabs.city>
copyright:          TODO
category:           TODO
build-type:         Simple
tested-with:        GHC ==9.2.8
extra-source-files:
  data/alonzo-params.json
  data/babbage-params.json
  data/protocol-params.json

common lang
  default-language:   GHC2021
  default-extensions:
    NoImplicitPrelude
    BangPatterns
    BinaryLiterals
    ConstraintKinds
    DataKinds
    DeriveAnyClass
    DeriveFunctor
    DeriveGeneric
    DeriveTraversable
    DerivingStrategies
    DerivingVia
    DuplicateRecordFields
    EmptyCase
    FlexibleContexts
    FlexibleInstances
    GADTs
    GeneralizedNewtypeDeriving
    HexFloatLiterals
    ImportQualifiedPost
    InstanceSigs
    KindSignatures
    LambdaCase
    MultiParamTypeClasses
    NumericUnderscores
    OverloadedStrings
    RecordWildCards
    ScopedTypeVariables
    StandaloneDeriving
    TemplateHaskell
    TupleSections
    TypeApplications
    TypeFamilies
    TypeOperators
    TypeSynonymInstances
    ViewPatterns

  ghc-options:
    -Wall -Wcompat -Wredundant-constraints -Wmissing-export-lists
    -Werror -Wincomplete-record-updates -fobject-code
    -fno-ignore-interface-pragmas -fno-omit-interface-pragmas
    -fno-specialise -Wno-partial-type-signatures

  -- expose all unfoldings, so plutustx compiler can do its job
  ghc-options:
    -fexpose-all-unfoldings -fobject-code
    -fplugin-opt PlutusTx.Plugin:defer-errors
  -- set target plutus-core version
  ghc-options: -fplugin-opt PlutusTx.Plugin:target-version=1.0.0

common deps
  build-depends:
    , aeson
    , array
    , base
    , base16-bytestring
    , base58-bytestring
    , bytestring
    , cardano-api
    , cardano-binary
    , cardano-crypto
    , cardano-ledger-core:testlib
    , cardano-crypto-class
    , cardano-ledger-mary
    , cardano-ledger-alonzo
    , cardano-ledger-babbage
    , cardano-ledger-core
    , cardano-ledger-shelley
    , cardano-ledger-shelley-ma
    , cardano-slotting
    , cardano-strict-containers
    , cborg
    , containers
    , cryptonite
    , data-default
    , deepseq
    , flat
    , hashable
    , http-api-data
    , memory
    , mtl
    , plutus-core
    , plutus-ledger-api
    , plutus-tx
    , plutus-tx-plugin
    , prettyprinter
    , serialise
    , tagged
    , text
    , time
    , vector

common test-deps
  import:        deps
  build-depends:
    , tasty
    , tasty-hunit

-- , tasty-expected-failure

library
  import:          lang
  import:          deps
  exposed-modules:
    Plutus.Model
    Plutus.Model.Ada
    Plutus.Model.Contract
    Plutus.Model.Mint
    Plutus.Model.Mock
    Plutus.Model.Mock.Address
    Plutus.Model.Mock.FailReason
    Plutus.Model.Mock.Log
    Plutus.Model.Mock.MockConfig
    Plutus.Model.Mock.Percent
    Plutus.Model.Mock.ProtocolParameters
    Plutus.Model.Mock.Stat
    Plutus.Model.Pretty
    Plutus.Model.Stake
    Plutus.Model.V1
    Plutus.Model.V2
    Plutus.Model.Validator
    Plutus.Model.Validator.V1
    Plutus.Model.Validator.V1.Plutus
    Plutus.Model.Validator.V2
    Plutus.Model.Validator.V2.Plutus

  build-depends:
    , cardano-simple
    , tasty
    , tasty-hunit

  other-modules:   Paths_plutus_simple_model
  hs-source-dirs:  src

test-suite plutus-simple-model-test
  import:         lang
  import:         deps
  import:         test-deps
  type:           exitcode-stdio-1.0
  main-is:        Spec.hs
  other-modules:
    Suites.Plutus.Model.FakeCoin
    Suites.Plutus.Model.Script.V1
    Suites.Plutus.Model.Script.V1.Onchain.Counter
    Suites.Plutus.Model.Script.V1.Onchain.Counter.Script
    Suites.Plutus.Model.Script.V1.Onchain.Game
    Suites.Plutus.Model.Script.V1.Onchain.Game.Script
    Suites.Plutus.Model.Script.V1.Onchain.Nft
    Suites.Plutus.Model.Script.V1.Onchain.Safe
    Suites.Plutus.Model.Script.V1.Onchain.Safe.Script
    Suites.Plutus.Model.Script.V1.Onchain.Staking
    Suites.Plutus.Model.Script.V1.Test.Counter
    Suites.Plutus.Model.Script.V1.Test.Game
    Suites.Plutus.Model.Script.V1.Test.Nft
    Suites.Plutus.Model.Script.V1.Test.Safe
    Suites.Plutus.Model.Script.V1.Test.Staking
    Suites.Plutus.Model.Script.V2
    Suites.Plutus.Model.Script.V2.Onchain.Game
    Suites.Plutus.Model.Script.V2.Onchain.Game.Script
    Suites.Plutus.Model.Script.V2.Onchain.Lend
    Suites.Plutus.Model.Script.V2.Onchain.Lend.Script
    Suites.Plutus.Model.Script.V2.Onchain.Oracle
    Suites.Plutus.Model.Script.V2.Onchain.Oracle.Hashed
    Suites.Plutus.Model.Script.V2.Onchain.Oracle.Inlined
    Suites.Plutus.Model.Script.V2.Test.Game
    Suites.Plutus.Model.Script.V2.Test.GameRef
    Suites.Plutus.Model.Script.V2.Test.Lend
    Suites.Plutus.Model.Script.V2.Test.Oracle.Hashed
    Suites.Plutus.Model.Script.V2.Test.Oracle.Inlined
    Suites.Plutus.Model.User
    Suites.Plutus.Model.Util

  build-depends:
    , plutus-simple-model
    , plutus-tx-plugin
    , cardano-simple

  hs-source-dirs: test
